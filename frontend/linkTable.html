{{ define "link" }}
<div id="bookmark-{{.ID}}">
	<div>
		<a data-hx-target="#bookmark-{{.ID}}" data-hx-patch="/bookmarks/{{.ID}}?action=bump"             >‚è´</a>
		{{ if and (not .URL) (not .Description ) }}
		{{ .Title }}
		{{ else if (not .URL) }}
		<details><summary>{{.Title}}</summary>{{.Description}}</details>
		{{ else }}
		<a href="{{.URL}}" title="{{ .Title }}" target="_blank" rel="noopener noreferrer">{{ .Title }} ({{ .URL }})</a>
		{{ with .Description }}<article>{{ . }}</article>{{end}}
		{{ if not (or (eq .LastStatusCode 200)) }}<span>‚ö†Ô∏è {{.LastStatusCode}} {{.LastStatusCode | httpStatusCode}} - {{ .LastStatusReason }}</span>{{ end }}
		{{ end }}
		<a data-hx-target="#bookmark-{{.ID}}" data-hx-patch="/bookmarks/{{.ID}}?action=update&inbox=read">‚úî</a>
		<a data-hx-target="#bookmark-{{.ID}}" data-hx-delete="/bookmarks/{{.ID}}"                        hx-confirm="Confirm delete?">üóëÔ∏è</a>
	</div>
</div>
{{ end }}
{{ $nextPage := .NextPage }}
{{ $previousLastDate := .PreviousLastDate }}
{{ with .Links }}
	{{ $lastDate := "" }}
	{{- range $_, $links := . }}
		<div class="dategroup" id="date-{{ .Date | slugify }}">
			{{ if ne $previousLastDate .Date }}
			<hr/>
			<div>{{ .Date }}</div>
			{{ end }}
			{{ range .Links }}
			{{ template "link" . }}
			{{ end }}
			{{ $lastDate = .Date }}
		</div>
	{{- end }}
	{{ if gt $nextPage -1 }}
	<div hx-get="?page={{ $nextPage }}&lastDate={{ $lastDate }}" hx-trigger="revealed" hx-swap="beforeend" hx-target="#container"></div>
	{{ end }}
{{ end }}
